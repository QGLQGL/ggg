import matplotlib.pyplot as plt
from sklearn.datasets import fetch_lfw_people

faces = fetch_lfw_people()
faces.daata.shape

faces.images.shape

import numpy as np

random_indexs = np.random.permutation(len(faces.data))
X = faces.data[random_indexs]
example_faces = X[:36, :]
example_faces.shape


def plot_digits(data):
    fig, axes = plt.subplots(6, 6, figsize=(10, 10), subplot_kw={'xticks':[], 'yticks':[]}, gridspec_kw=dict(hspace=0.1, wspace=0.1))
    for i, ax in enumerate(axes.flat):
        ax.imshow(data[i].reshape(62, 47), cmap='bone')

plot_digits(example_faces)

faces.target_names

print(len(faces.target_names))

X, y = faces.data, faces.target
from sklearn.decomposition import PCA
pca = PCA(svd_solver='randomized')
pca.components_.shape




















